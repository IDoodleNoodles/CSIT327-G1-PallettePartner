{% extends "base.html" %}
{% load static %}

{% block title %}{{ collaboration.title|default:"Collaboration" }} | PallettePartner{% endblock %}

{% block content %}
<div class="min-h-screen flex bg-[#050819] text-[#E5E7EB]">

  <!-- LEFT MENU (same as messages page) -->
  <aside class="bg-[#050819] w-64 flex flex-col py-8 px-6 border-r border-[#111827] shadow-xl">
    <h1 class="text-base font-semibold text-white flex items-center gap-2 mb-8">
      <span>Menu</span>
    </h1>

    <nav class="flex flex-col gap-3 text-sm font-medium text-[#CBD5F5]">
      <a href="{% url 'pallate:dashboard' %}"
         class="flex items-center gap-3 px-3 py-2 rounded-lg hover:bg-[#12172D] hover:text-white">
        <img src="{% static 'icon/home_icon.png' %}" class="w-5 h-5" alt="Home">
        <span>Dashboard</span>
      </a>

      <a href="{% url 'pallate:artist_profile_by_id' request.user.id %}"
         class="flex items-center gap-3 px-3 py-2 rounded-lg hover:bg-[#12172D] hover:text-white">
        <img src="{% static 'icon/artist_icon.png' %}" class="w-5 h-5" alt="Artist">
        <span>Artist</span>
      </a>

      <a href="{% url 'pallate:collaboration_detail_legacy' %}"
         class="flex items-center gap-3 px-3 py-2 rounded-lg bg-[#12172D] text-white">
        <img src="{% static 'icon/collabpost_icon.png' %}" class="w-5 h-5" alt="Collaboration">
        <span>Collaboration</span>
      </a>

      <a href="{% url 'pallate:upload_artwork' %}"
         class="flex items-center gap-3 px-3 py-2 rounded-lg hover:bg-[#12172D] hover:text-white">
        <img src="{% static 'icon/Upload_artwork_icon.png' %}" class="w-5 h-5" alt="Upload">
        <span>Upload Artworks</span>
      </a>

      <a href="{% url 'pallate:favorites' %}"
         class="flex items-center gap-3 px-3 py-2 rounded-lg hover:bg-[#12172D] hover:text-white">
        <img src="{% static 'icon/favorite_icon.png' %}" class="w-5 h-5" alt="Favorites">
        <span>Favorites</span>
      </a>

      <a href="{% url 'pallate:profile' %}"
         class="flex items-center gap-3 px-3 py-2 rounded-lg hover:bg-[#12172D] hover:text-white">
        <img src="{% static 'icon/profile_icon.png' %}" class="w-5 h-5" alt="Profile">
        <span>My Profile</span>
      </a>
    </nav>

    <div class="mt-auto pt-8 border-t border-[#111827]">
      <a href="#"
         class="flex items-center gap-3 px-3 py-2 rounded-lg hover:bg-[#12172D] hover:text-white text-sm">
        <img src="{% static 'icon/settings_icon.png' %}" class="w-5 h-5" alt="Settings">
        <span>Settings</span>
      </a>
    </div>
  </aside>

  <!-- RIGHT SIDE -->
  <main class="flex-1 flex flex-col bg-[#050819] overflow-y-auto">
    <!-- TOP BAR (same style as messages) -->
    <header class="flex items-center justify-between px-10 py-4">
      <div class="flex items-center gap-3">
        <div>
          <p class="text-sm text-[#9CA3AF]">Collaboration Overview</p>
          <h1 class="text-xl font-semibold text-[#A7F3D0]">
            {{ collaboration.title }}
          </h1>
        </div>
      </div>

      <form action="{% url 'pallate:logout' %}" method="post">
        {% csrf_token %}
        <button type="submit"
                class="bg-[#8B5CF6] hover:bg-[#7C3AED] text-white font-semibold px-5 py-1.5 rounded-full text-sm transition">
          Logout
        </button>
      </form>
    </header>

    <!-- HERO BANNER (matches message hero) -->
    <section class="px-10 pb-4">
      <div class="relative w-full h-48 rounded-3xl overflow-hidden">
        <img src="{% static 'icon/dashboard_banner.jpg' %}"
             onerror="this.style.display='none'"
             class="w-full h-full object-cover" alt="Banner">
        <div class="absolute inset-0 bg-gradient-to-r from-[#050819]/90 via-[#050819]/40 to-transparent flex flex-col justify-center px-10">
          <h2 class="text-2xl font-bold text-white mb-1">
            {{ collaboration.title }}
          </h2>
          <p class="text-sm text-[#E5E7EB]/80">
            Chat with artists in this collaboration room and manage project details here.
          </p>
        </div>
      </div>
    </section>

    <!-- MAIN DETAILS GRID (styled to match overall UI) -->
    <section class="px-10 pb-10">
      <div class="grid grid-cols-1 lg:grid-cols-[minmax(0,_2.1fr)_minmax(320px,_1fr)] gap-8">

        <!-- LEFT: Project details card -->
        <section class="bg-[#0B1221] rounded-3xl border border-[#1F2937] shadow-2xl px-7 py-6 flex flex-col gap-6">
          <!-- Header -->
          <header class="flex items-start justify-between gap-4">
            <div class="flex items-center gap-4">
              {% if owner_profile and owner_profile.avatar %}
                <img src="{{ owner_profile.avatar.url }}"
                     alt="{{ owner.username }}"
                     class="w-12 h-12 rounded-full object-cover border border-[#111827]">
              {% else %}
                <div class="w-12 h-12 rounded-full bg-[#111827] flex items-center justify-center border border-[#1F2937]">
                  <span class="text-lg font-semibold">
                    {{ owner.username|first|upper }}
                  </span>
                </div>
              {% endif %}

              <div>
                <p class="text-sm font-semibold text-white">
                  {{ owner.get_full_name|default:owner.username }}
                </p>
                <p class="text-xs text-[#9CA3AF]">Project Owner</p>
              </div>
            </div>

            <div class="text-right space-y-1">
              <span class="inline-flex items-center px-3 py-1 rounded-full bg-emerald-500/90 text-xs font-semibold text-[#041316]">
                Active
              </span>
              <p class="text-[11px] text-[#9CA3AF]">
                Posted {{ collaboration.created_at|timesince }} ago
              </p>
            </div>
          </header>

          <!-- Title + subtitle -->
          <div>
            <h1 class="text-3xl font-bold text-white mb-2">
              {{ collaboration.title }}
            </h1>
            <p class="text-sm text-[#9CA3AF]">
              Chat with artists in this collaboration room and manage project details here.
            </p>
          </div>

          <!-- Tags -->
          <div class="flex flex-wrap gap-2">
            <span class="px-3 py-1 rounded-full text-xs font-medium bg-[#4C1D95]/50 text-[#E9D5FF] border border-[#4C1D95]">
              Illustration
            </span>
            <span class="px-3 py-1 rounded-full text-xs font-medium bg-[#1D4ED8]/40 text-[#DBEAFE] border border-[#1D4ED8]">
              Fantasy
            </span>
            <span class="px-3 py-1 rounded-full text-xs font-medium bg-[#111827] text-[#E5E7EB] border border-[#374151]">
              Book Cover
            </span>
          </div>

          <!-- Description -->
          <section class="space-y-2">
            <h2 class="text-lg font-semibold text-white">Project Description</h2>
            <p class="text-sm leading-relaxed text-[#D1D5DB]">
              {{ collaboration.description }}
            </p>
          </section>

          <!-- Requirements -->
          <section class="space-y-2">
            <h2 class="text-lg font-semibold text-white">Project Requirements</h2>
            <ul class="text-sm text-[#D1D5DB] space-y-1 list-disc list-inside">
              <li>High-resolution artwork (300 DPI minimum)</li>
              <li>Multiple format versions (front cover, full wrap, ebook)</li>
              <li>Regular progress updates between collaborators</li>
              <li>Commercial usage rights included</li>
            </ul>
          </section>

          <!-- Roles -->
          <section class="space-y-3">
            <h2 class="text-lg font-semibold text-white">Roles Needed</h2>

            <div class="p-4 bg-[#050819] rounded-2xl border border-[#1F2937] flex justify-between items-center">
              <div>
                <p class="font-semibold flex items-center gap-2">
                  <span class="text-[#A855F7] text-lg">üé®</span>
                  Lead Illustrator
                </p>
                <p class="text-xs text-[#9CA3AF] mt-1">
                  $2,800 ‚Ä¢ 3 weeks ‚Ä¢ Full cover set
                </p>
              </div>
              <span class="text-xs font-semibold text-emerald-400">Filled</span>
            </div>

            <div class="p-4 bg-[#050819] rounded-2xl border border-[#1F2937]">
              <div class="flex justify-between items-center">
                <div>
                  <p class="font-semibold flex items-center gap-2">
                    <span class="text-[#FBBF24] text-lg">üåà</span>
                    Color Specialist
                  </p>
                  <p class="text-xs text-[#9CA3AF] mt-1">
                    $500 ‚Ä¢ 1 week ‚Ä¢ Final color polish
                  </p>
                </div>
                <span class="text-xs font-semibold text-amber-300">Open</span>
              </div>
              <button type="button"
                      class="mt-3 inline-flex items-center justify-center px-4 py-2 rounded-full bg-gradient-to-r from-[#8B5CF6] to-[#6366F1] text-xs font-semibold text-white hover:opacity-90 transition">
                Apply for this role
              </button>
            </div>
          </section>
        </section>

        <!-- RIGHT: Discussion card (matches theme + links to chat UI) -->
        <aside class="bg-[#0B1221] rounded-3xl border border-[#1F2937] shadow-2xl px-6 py-6 flex flex-col gap-4">
          <header class="space-y-1">
            <p class="text-xs uppercase tracking-wide text-[#6B7280]">Project Discussion</p>
            <h3 class="text-lg font-semibold text-white">Open Messages</h3>
            <p class="text-sm text-[#9CA3AF]">
              Use the collaboration chat view to talk in real time with artists interested in this project.
            </p>
          </header>

          <a href="{% url 'pallate:collab_messages' collaboration.id %}"
             class="mt-2 inline-flex items-center justify-center px-4 py-3 rounded-full bg-[#A7F3D0] hover:bg-[#7BE5B4] text-sm font-semibold text-[#050819] transition">
            Go to collaboration chat
          </a>

          <!-- New Feature Links -->
          <div class="mt-4 border-t border-[#111827] pt-4 space-y-2">
            {% if collaboration.user == request.user %}
            <a href="{% url 'pallate:collaboration_matches' collaboration.id %}"
               class="block w-full px-4 py-2 rounded-lg bg-[#8B5CF6] hover:bg-purple-600 text-white text-center text-sm font-semibold transition">
              ü§ù Find Suggested Matches
            </a>
            {% endif %}
            
            <a href="{% url 'pallate:collaboration_feedback' collaboration.id %}"
               class="block w-full px-4 py-2 rounded-lg bg-gray-700 hover:bg-gray-600 text-white text-center text-sm font-semibold transition">
              ‚≠ê Rate Collaboration
            </a>
          </div>

          <div class="mt-4 border-t border-[#111827] pt-4 text-xs text-[#6B7280] space-y-2">
            <p>Tip: keep all project decisions inside the chat so everyone stays aligned.</p>
            <p>New messages will also trigger notifications in your dashboard.</p>
          </div>
        </aside>
      </div>
    </section>
  </main>
</div>
{% endblock %}