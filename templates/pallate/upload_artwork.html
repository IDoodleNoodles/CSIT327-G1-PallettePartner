{% extends "base.html" %}
{% load static %}
{% block title %}Upload Artwork{% endblock %}
{% block content %}
<div class="min-h-screen bg-[#0B1221] py-8 px-4">
  <!-- Back Button -->
  <div class="max-w-2xl mx-auto mb-4">
    <a href="{% url 'pallate:dashboard' %}" class="inline-flex items-center gap-2 bg-gradient-to-r from-[#8B5CF6] to-[#6366F1] hover:from-[#7C3AED] hover:to-[#4F46E5] text-white px-4 py-2 rounded-full font-semibold transition-all duration-300 transform hover:scale-105 shadow-lg hover:shadow-[#8B5CF6]/50 animate-pulse">
      <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18"/>
      </svg>
      <span>‚Üê Dashboard</span>
    </a>
  </div>

  <!-- Decorative header with artistic elements -->
  <div class="max-w-2xl mx-auto relative mb-6">
    <!-- Decorative paintbrush element -->
    <div class="absolute -top-6 -right-6 w-16 h-16 opacity-10 animate-bounce">
      <svg viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
        <path d="M20,20 Q50,10 80,20 T90,50 Q80,80 50,90 T20,80 Q10,50 20,20" fill="#8B5CF6"/>
      </svg>
    </div>
    
    <h2 class="text-3xl font-bold text-[#A7F3D0] text-center mb-2 flex items-center justify-center gap-3">
      <span class="text-2xl">üñåÔ∏è</span>
      Upload Your Artwork
      <span class="text-2xl">üé®</span>
    </h2>
    <p class="text-center text-[#9CA3AF]">Share your creativity with the community</p>
  </div>

  <div class="max-w-2xl mx-auto bg-[#1A2035] text-[#E5E7EB] p-8 rounded-xl shadow-lg border border-[#232B46] relative overflow-hidden">
    <!-- Decorative corner elements -->
    <div class="absolute top-0 right-0 w-24 h-24 opacity-5 -z-10 animate-pulse">
      <svg viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
        <circle cx="50" cy="50" r="45" fill="#A7F3D0"/>
      </svg>
    </div>
    
    <div class="absolute bottom-0 left-0 w-20 h-20 opacity-5 -z-10 animate-pulse">
      <svg viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
        <polygon points="50,5 90,95 10,95" fill="#8B5CF6"/>
      </svg>
    </div>
    
    <!-- Image Preview -->
    <div id="imagePreview" class="hidden mb-6">
      <div class="relative rounded-lg overflow-hidden border-2 border-[#A7F3D0] max-h-96 shadow-lg animate-pulse">
        <img id="previewImg" src="" alt="Preview" class="w-full h-auto object-contain">
        <button type="button" id="removePreview" class="absolute top-2 right-2 bg-red-500 hover:bg-red-600 text-white rounded-full p-2 transition transform hover:scale-110 duration-300 shadow-lg hover:shadow-red-500/30">
          <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
          </svg>
        </button>
      </div>
      <p class="text-sm text-[#9CA3AF] mt-2 text-center" id="fileName"></p>
    </div>
    
  <form method="POST" enctype="multipart/form-data" class="space-y-5">
    {% csrf_token %}
    
    <!-- Title Field -->
    <div class="space-y-2">
      <label for="id_title" class="block text-[#A7F3D0] font-semibold flex items-center gap-2">
        <span>‚úèÔ∏è</span> Title
      </label>
      <input type="text" name="title" maxlength="255" id="id_title" placeholder="Artwork Title" class="w-full px-4 py-3 rounded-lg bg-gray-800 text-gray-200 border border-gray-700 focus:outline-none focus:ring-2 focus:ring-accent-purple transition duration-300">
    </div>
    
    <!-- Description Field -->
    <div class="space-y-2">
      <label for="id_description" class="block text-[#A7F3D0] font-semibold flex items-center gap-2">
        <span>üìù</span> Description
      </label>
      <textarea name="description" cols="40" rows="4" id="id_description" placeholder="Describe your artwork..." class="w-full px-4 py-3 rounded-lg bg-gray-800 text-gray-200 border border-gray-700 focus:outline-none focus:ring-2 focus:ring-accent-purple transition duration-300"></textarea>
    </div>
    
    <!-- Image Upload Field -->
    <div class="space-y-2">
      <label for="id_image" class="block text-[#A7F3D0] font-semibold flex items-center gap-2">
        <span>üñºÔ∏è</span> Upload Image
      </label>
      <input type="file" name="image" accept="image/*" id="id_image" class="block w-full text-sm text-gray-200 file:mr-4 file:py-2 file:px-4 file:rounded-md file:border-0 file:text-sm file:font-semibold file:bg-gradient-to-r file:from-[#8B5CF6] file:to-[#6366F1] file:text-white hover:file:from-[#7C3AED] hover:file:to-[#4F46E5] file:transition file:duration-300">
    </div>
    
    <!-- Category Selection -->
    <div class="space-y-2">
      <label class="block text-[#A7F3D0] font-semibold flex items-center gap-2">
        <span>üè∑Ô∏è</span> Categories
      </label>
      
      <!-- Dropdown Button -->
      <div class="relative">
        <button type="button" id="categoryDropdownButton" class="w-full px-4 py-3 rounded-lg bg-gray-800 text-gray-200 border border-gray-700 focus:outline-none focus:ring-2 focus:ring-accent-purple text-left flex justify-between items-center transition duration-300">
          <span id="categoryButtonText">Select Categories</span>
          <svg class="w-5 h-5 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"/>
          </svg>
        </button>
        
        <!-- Dropdown Panel -->
        <div id="categoryDropdown" class="hidden absolute z-10 mt-1 w-full bg-[#1A2035] border border-[#232B46] rounded-lg shadow-lg shadow-[#000000]/20 animate-fade-in" style="max-height: 300px; overflow-y: auto; position: relative; z-index: 9999;">
          <div class="p-2">
            <!-- Category Items -->
            <label class="flex items-center p-2 hover:bg-[#232B46] cursor-pointer rounded transition duration-300 hover:scale-105">
              <input type="checkbox" name="categories" value="Digital Art" class="mr-2 text-[#8B5CF6] focus:ring-[#8B5CF6] rounded">
              <span class="flex items-center gap-2">
                <span class="w-4 h-4 inline-block rounded-sm border border-[#8B5CF6] flex items-center justify-center"></span>
                Digital Art
              </span>
            </label>
            
            <label class="flex items-center p-2 hover:bg-[#232B46] cursor-pointer rounded transition duration-300 hover:scale-105">
              <input type="checkbox" name="categories" value="Traditional Art" class="mr-2 text-[#8B5CF6] focus:ring-[#8B5CF6] rounded">
              <span class="flex items-center gap-2">
                <span class="w-4 h-4 inline-block rounded-sm border border-[#8B5CF6] flex items-center justify-center"></span>
                Traditional Art
              </span>
            </label>
            
            <label class="flex items-center p-2 hover:bg-[#232B46] cursor-pointer rounded transition duration-300 hover:scale-105">
              <input type="checkbox" name="categories" value="Photography" class="mr-2 text-[#8B5CF6] focus:ring-[#8B5CF6] rounded">
              <span class="flex items-center gap-2">
                <span class="w-4 h-4 inline-block rounded-sm border border-[#8B5CF6] flex items-center justify-center"></span>
                Photography
              </span>
            </label>
            
            <label class="flex items-center p-2 hover:bg-[#232B46] cursor-pointer rounded transition duration-300 hover:scale-105">
              <input type="checkbox" name="categories" value="Illustration" class="mr-2 text-[#8B5CF6] focus:ring-[#8B5CF6] rounded">
              <span class="flex items-center gap-2">
                <span class="w-4 h-4 inline-block rounded-sm border border-[#8B5CF6] flex items-center justify-center"></span>
                Illustration
              </span>
            </label>
            
            <label class="flex items-center p-2 hover:bg-[#232B46] cursor-pointer rounded transition duration-300 hover:scale-105">
              <input type="checkbox" name="categories" value="Graphic Design" class="mr-2 text-[#8B5CF6] focus:ring-[#8B5CF6] rounded">
              <span class="flex items-center gap-2">
                <span class="w-4 h-4 inline-block rounded-sm border border-[#8B5CF6] flex items-center justify-center"></span>
                Graphic Design
              </span>
            </label>
            
            <label class="flex items-center p-2 hover:bg-[#232B46] cursor-pointer rounded transition duration-300 hover:scale-105">
              <input type="checkbox" name="categories" value="3D Art" class="mr-2 text-[#8B5CF6] focus:ring-[#8B5CF6] rounded">
              <span class="flex items-center gap-2">
                <span class="w-4 h-4 inline-block rounded-sm border border-[#8B5CF6] flex items-center justify-center"></span>
                3D Art
              </span>
            </label>
            
            <label class="flex items-center p-2 hover:bg-[#232B46] cursor-pointer rounded transition duration-300 hover:scale-105">
              <input type="checkbox" name="categories" value="Animation" class="mr-2 text-[#8B5CF6] focus:ring-[#8B5CF6] rounded">
              <span class="flex items-center gap-2">
                <span class="w-4 h-4 inline-block rounded-sm border border-[#8B5CF6] flex items-center justify-center"></span>
                Animation
              </span>
            </label>
            
            <label class="flex items-center p-2 hover:bg-[#232B46] cursor-pointer rounded transition duration-300 hover:scale-105">
              <input type="checkbox" name="categories" value="Concept Art" class="mr-2 text-[#8B5CF6] focus:ring-[#8B5CF6] rounded">
              <span class="flex items-center gap-2">
                <span class="w-4 h-4 inline-block rounded-sm border border-[#8B5CF6] flex items-center justify-center"></span>
                Concept Art
              </span>
            </label>
          </div>
          
          <!-- Action Buttons -->
          <div class="flex justify-between p-2 border-t border-[#232B46]">
            <button type="button" id="clearFilters" class="px-3 py-1 text-sm text-[#8B5CF6] border border-[#8B5CF6] rounded hover:bg-[#8B5CF6]/10 transition duration-300 hover:scale-105">
              Clear
            </button>
            <button type="button" id="applyFilters" class="px-3 py-1 text-sm text-white bg-gradient-to-r from-[#8B5CF6] to-[#6366F1] rounded hover:from-[#7C3AED] hover:to-[#4F46E5] transition duration-300 hover:scale-105">
              Apply
            </button>
          </div>
        </div>
      </div>
      
      <!-- Hidden input to store selected categories -->
      <input type="hidden" name="selected_categories" id="selectedCategories">
    </div>
    
    <div class="flex gap-3 justify-end pt-4">
      <a href="{% url 'pallate:dashboard' %}" class="bg-gradient-to-r from-gray-700 to-gray-600 hover:from-gray-600 hover:to-gray-500 text-[#E5E7EB] px-5 py-2 rounded-lg font-semibold transition transform hover:scale-105 duration-300 flex items-center gap-2">
        <span>‚ùå</span> Cancel
      </a>
      <button type="submit" id="submitBtn" class="bg-gradient-to-r from-[#A7F3D0] to-[#7BE5B4] hover:from-[#7BE5B4] hover:to-[#5DD19D] text-[#0A0A1F] px-5 py-2 rounded-lg font-semibold transition transform hover:scale-105 duration-300 shadow-lg flex items-center gap-2">
        <span id="submitText">üì§ Upload Artwork</span>
        <span id="submitLoader" class="hidden">üì§ Uploading...</span>
      </button>
    </div>
  </form>
  </div>
</div>

<script>
  document.addEventListener('DOMContentLoaded', function() {
    // Image preview functionality
    const imageInput = document.querySelector('input[type="file"][accept="image/*"]');
    const imagePreview = document.getElementById('imagePreview');
    const previewImg = document.getElementById('previewImg');
    const fileName = document.getElementById('fileName');
    const removePreview = document.getElementById('removePreview');
    const form = document.querySelector('form');
    const submitBtn = document.getElementById('submitBtn');
    const submitText = document.getElementById('submitText');
    const submitLoader = document.getElementById('submitLoader');
    
    if (imageInput) {
      imageInput.addEventListener('change', function(e) {
        const file = e.target.files[0];
        if (file && file.type.startsWith('image/')) {
          const reader = new FileReader();
          reader.onload = function(e) {
            previewImg.src = e.target.result;
            imagePreview.classList.remove('hidden');
            fileName.textContent = file.name;
          };
          reader.readAsDataURL(file);
        }
      });
    }
    
    if (removePreview) {
      removePreview.addEventListener('click', function() {
        imageInput.value = '';
        imagePreview.classList.add('hidden');
        previewImg.src = '';
        fileName.textContent = '';
      });
    }
    
    // Show loading state on submit
    if (form) {
      form.addEventListener('submit', function() {
        submitBtn.disabled = true;
        submitText.classList.add('hidden');
        submitLoader.classList.remove('hidden');
      });
    }
    
    // Category dropdown functionality
    const categoryDropdownButton = document.getElementById('categoryDropdownButton');
    const categoryDropdown = document.getElementById('categoryDropdown');
    const categoryCheckboxes = document.querySelectorAll('input[name="categories"]');
    const categoryButtonText = document.getElementById('categoryButtonText');
    const applyFilters = document.getElementById('applyFilters');
    const clearFilters = document.getElementById('clearFilters');
    const selectedCategoriesInput = document.getElementById('selectedCategories');
    
    // Toggle dropdown visibility
    categoryDropdownButton.addEventListener('click', function() {
      categoryDropdown.classList.toggle('hidden');
    });
    
    // Close dropdown when clicking outside
    document.addEventListener('click', function(event) {
      if (!categoryDropdownButton.contains(event.target) && !categoryDropdown.contains(event.target)) {
        categoryDropdown.classList.add('hidden');
      }
    });
    
    // Update checkbox visuals when clicked
    // Update checkbox visuals when clicked
    categoryCheckboxes.forEach(checkbox => {
      checkbox.addEventListener('change', function() {
        const span = this.nextElementSibling.querySelector('span span');
        if (this.checked) {
          span.classList.add('bg-[#8B5CF6]');
          span.innerHTML = '<svg class="w-3 h-3 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="3" d="M5 13l4 4L19 7"></path></svg>';
        } else {
          span.classList.remove('bg-[#8B5CF6]');
          span.innerHTML = '';
        }
      });
    });
    
    // Update button text based on selections
    function updateButtonText() {
      const checkedBoxes = document.querySelectorAll('input[name="categories"]:checked');
      if (checkedBoxes.length === 0) {
        categoryButtonText.textContent = 'üè∑Ô∏è Select Categories';
      } else if (checkedBoxes.length === 1) {
        categoryButtonText.textContent = `üè∑Ô∏è ${checkedBoxes[0].value}`;
      } else {
        categoryButtonText.textContent = `üè∑Ô∏è ${checkedBoxes.length} categories selected`;
      }
    }
    
    // Apply filters button
    applyFilters.addEventListener('click', function() {
      const checkedValues = Array.from(document.querySelectorAll('input[name="categories"]:checked'))
        .map(cb => cb.value);
      
      selectedCategoriesInput.value = checkedValues.join(',');
      categoryDropdown.classList.add('hidden');
      updateButtonText();
      
      // Add visual feedback
      categoryDropdownButton.classList.add('ring-2', 'ring-[#A7F3D0]');
      setTimeout(() => {
        categoryDropdownButton.classList.remove('ring-2', 'ring-[#A7F3D0]');
      }, 1000);
    });
    
    // Clear filters button
    clearFilters.addEventListener('click', function() {
      categoryCheckboxes.forEach(cb => {
        cb.checked = false;
        // Update visuals
        const span = cb.nextElementSibling.querySelector('span span');
        span.classList.remove('bg-[#8B5CF6]');
        span.innerHTML = '';
      });
      selectedCategoriesInput.value = '';
      updateButtonText();
    });
    
    // Update button text when checkboxes change
    categoryCheckboxes.forEach(cb => {
      cb.addEventListener('change', updateButtonText);
    });
    
    // Initialize button text
    updateButtonText();
  });
</script>
{% endblock %}