{% extends "base.html" %}
{% load static %}

{% block title %}Dashboard | PallettePartner{% endblock %}

{% block content %}
<div class="min-h-screen flex flex-col bg-[#0B1221] text-[#E5E7EB]">

  <!-- Navbar -->
  <header class="flex items-center justify-between bg-[#0D1426] border-b border-[#1E2639] h-14 px-6 sticky top-0 z-50 shadow-md">
    <div class="flex items-center gap-5 w-full">
      <!-- Logo -->
      <div class="flex items-center gap-2 font-bold text-lg">
        <img src="{% static 'icon/dashboard.png' %}" alt="Logo" class="w-6 h-6">
        <span class="bg-gradient-to-r from-[#4F46E5] to-[#8B5CF6] bg-clip-text text-transparent">PallettePartner</span>
      </div>

      <!-- Searchbar -->
      <div class="flex items-center w-1/2 bg-[#1A2035] rounded-md px-3 py-1.5 border border-[#232B46]">
        <img src="{% static 'icon/search_icon.png' %}" alt="Search" class="w-4 h-4 opacity-60 mr-2">
        <input type="text" placeholder="Search projects, artists, or skills..." 
               class="bg-transparent text-sm w-full text-[#E5E7EB] placeholder-[#9CA3AF] focus:outline-none">
      </div>
    </div>

    <!-- Right icons -->
    <div class="flex items-center gap-4 relative">
      <!-- Notifications dropdown -->
      <div class="relative group">
        <button class="relative hover:opacity-80 transition">
          <img src="{% static 'icon/notification_icon.png' %}" class="w-5 h-5">
          <span class="absolute -top-1 -right-1 w-2 h-2 bg-[#4ADE80] rounded-full"></span>
        </button>
        <div class="hidden group-hover:flex flex-col absolute right-0 mt-2 w-56 bg-[#1A2035] border border-[#232B46] rounded-lg shadow-lg p-3 text-sm z-50">
          <p class="text-[#A7F3D0] font-semibold mb-1">Notifications</p>
          <p class="text-[#9CA3AF] text-xs">No new notifications</p>
        </div>
      </div>

      <!-- Logout -->
      <form action="{% url 'pallate:logout' %}" method="post">
        {% csrf_token %}
        <button type="submit" class="bg-[#A7F3D0] hover:bg-[#7BE5B4] text-[#0A0A1F] font-semibold px-3 py-1.5 rounded-md text-sm transition">
          Logout
        </button>
      </form>
    </div>
  </header>

  <div class="flex flex-1 overflow-hidden">

    <!-- Sidebar -->
    <aside id="sidebar" 
      class="bg-[#0D1426] border-r border-[#1E2639] w-64 flex flex-col py-6 px-4 transition-all duration-500 ease-in-out overflow-y-auto shadow-lg">
      
      <div class="flex justify-between items-center mb-8">
        <h1 class="text-[1.1rem] font-semibold text-[#A7F3D0] flex items-center gap-2">
          <img src="{% static 'icon/navigation_icon.png' %}" id="toggleSidebar" class="w-6 h-6 cursor-pointer hover:opacity-80 transition" alt="Menu">
          <span id="menuLabel">Menu</span>
        </h1>
        <a href="{% url 'pallate:landing' %}" class="text-gray-400 hover:text-[#A7F3D0] transition">
          <img src="{% static 'icon/back_icon.png' %}" class="w-5 h-5" alt="Back">
        </a>
      </div>

      <nav class="flex flex-col space-y-3 font-medium text-[#9CA3AF]">
        <a href="{% url 'pallate:dashboard' %}" class="nav-item flex items-center gap-3 p-2 rounded-md hover:bg-[#1A2035] hover:text-[#A7F3D0] {% if request.path == '/dashboard/' %}bg-[#1A2035] text-[#A7F3D0]{% endif %}">
          <img src="{% static 'icon/home_icon.png' %}" class="w-5 h-5"> <span>Home</span>
        </a>
        <a href="{% url 'pallate:artist_profile' %}" class="nav-item flex items-center gap-3 p-2 rounded-md hover:bg-[#1A2035] hover:text-[#A7F3D0]">
          <img src="{% static 'icon/artist_icon.png' %}" class="w-5 h-5"> <span>Artists</span>
        </a>
        <a href="{% url 'pallate:collaboration_detail' %}" class="nav-item flex items-center gap-3 p-2 rounded-md hover:bg-[#1A2035] hover:text-[#A7F3D0]">
          <img src="{% static 'icon/collabpost_icon.png' %}" class="w-5 h-5"> <span>Collaborations</span>
        </a>
        <a href="{% url 'pallate:favorites' %}" class="nav-item flex items-center gap-3 p-2 rounded-md hover:bg-[#1A2035] hover:text-[#A7F3D0]">
          <img src="{% static 'icon/favorite_icon.png' %}" class="w-5 h-5"> <span>Favorite</span>
        </a>
        <a href="{% url 'pallate:profile' %}" class="nav-item flex items-center gap-3 p-2 rounded-md hover:bg-[#1A2035] hover:text-[#A7F3D0]">
          <img src="{% static 'icon/profile_icon.png' %}" class="w-5 h-5"> <span>My Profile</span>
        </a>
        <a href="#" class="nav-item flex items-center gap-3 p-2 rounded-md hover:bg-[#1A2035] hover:text-[#A7F3D0]">
          <img src="{% static 'icon/settings_icon.png' %}" class="w-5 h-5"> <span>Settings</span>
        </a>
      </nav>
    </aside>

    <!-- Main Content -->
    <main class="flex-1 overflow-y-auto bg-[#0B1221] px-8 py-8 space-y-6">
      {% if posts %}
        {% for post in posts %}
        <div class="bg-[#1A2035] border border-[#232B46] rounded-lg p-5 hover:border-[#A7F3D0] transition-all duration-300 shadow-sm">
          <h3 class="text-lg font-semibold text-[#A7F3D0]">{{ post.title }}</h3>
          <p class="text-[#9CA3AF] mt-2">{{ post.description }}</p>

          <div class="text-sm text-[#6B7280] mt-3 flex gap-4 items-center">
            <span>ðŸ‘¤ {{ post.user.username }}</span>
            <span>ðŸ•’ {{ post.created_at|timesince }} ago</span>
          </div>

          <!-- Action buttons -->
          <div class="flex gap-5 mt-4 items-center">
            <a href="{% url 'pallate:collab_messages' post.id %}" title="Message" class="hover:opacity-80 transition">
              <img src="{% static 'icon/message_icon.png' %}" class="w-5 h-5">
            </a>
            <a href="{% url 'pallate:artist_profile' %}?user={{ post.user.id }}" title="Artist Profile" class="hover:opacity-80 transition">
              <img src="{% static 'icon/artist_icon.png' %}" class="w-5 h-5">
            </a>
            <a href="{% url 'pallate:toggle_favorite' post.id %}" title="Favorite" class="hover:opacity-80 transition">
              <img src="{% static 'icon/favorite_icon.png' %}" class="w-5 h-5">
            </a>
            <a href="{% url 'pallate:send_collab_request' post.id %}" title="Request Collaboration" class="hover:opacity-80 transition">
              <img src="{% static 'icon/collabpost_icon.png' %}" class="w-5 h-5">
            </a>
          </div>
        </div>
        {% endfor %}
      {% else %}
      <div class="text-center text-[#9CA3AF] border border-[#232B46] rounded-xl py-12 bg-[#111827] mx-6 shadow-inner">
        No collaboration posts yet. Be the first to share your art!
      </div>
      {% endif %}
    </main>
  </div>

  <!-- Floating Create Button -->
  <button id="addPostBtn" class="fixed bottom-8 right-8 bg-[#A7F3D0] hover:bg-[#7BE5B4] text-[#0A0A1F] text-3xl font-bold rounded-full w-14 h-14 shadow-lg flex items-center justify-center transition-all duration-300">+</button>

  <!-- Overlay -->
  <div id="overlay" class="overlay"></div>

  <!-- Modal -->
  <div id="createModal" class="modal">
    <div class="modal-content bg-[#1A2035] border border-[#232B46] p-6 rounded-xl text-[#E5E7EB]">
      <h2 class="text-xl font-semibold text-[#A7F3D0] mb-4 text-center">Create New Collaboration</h2>
      <form method="POST" class="space-y-3">
        {% csrf_token %}
        {{ form.as_p }}
        <div class="flex justify-end gap-3">
          <button type="button" id="closeModal" class="px-4 py-2 bg-gray-600 hover:bg-gray-500 rounded-md text-white transition">Cancel</button>
          <button type="submit" class="px-4 py-2 bg-[#A7F3D0] hover:bg-[#7BE5B4] rounded-md text-[#0A0A1F] font-semibold transition">Post</button>
        </div>
      </form>
    </div>
  </div>

</div>

<!-- External JS -->
<script src="{% static 'js/dashboard.js' %}"></script>
{% endblock %}